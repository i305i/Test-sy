# ๐ ุงูุจุฏุงูุฉ ุงูุณุฑูุนุฉ - Backend

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ุงูุจููุฉ ุงูุฃุณุงุณูุฉ โ๏ธ
- โ Prisma Schema ูุงูู (16 Model)
- โ Database Module ูุน PrismaService
- โ Common Module (Filters, Decorators, DTOs)
- โ main.ts ู app.module.ts
- โ Health Check Endpoint

### 2. ุงูู Modules ุงูููุชููุฉ โ๏ธ

#### โ Auth Module (ูุธุงู ุงููุตุงุฏูุฉ)
- JWT Access & Refresh Tokens
- Passport Strategies (JWT, JWT Refresh, Local)
- Guards (JwtAuthGuard, LocalAuthGuard)
- Decorators (@Public, @CurrentUser)
- Login/Logout/Refresh/Me endpoints

#### โ Users Module (ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู)
- CRUD operations
- Role-based access
- Password hashing (bcrypt)
- User filtering & search

#### โ Companies Module (ุฅุฏุงุฑุฉ ุงูุดุฑูุงุช)
- ุฅูุดุงุก ูุชุนุฏูู ุงูุดุฑูุงุช
- Role-based permissions
- Completion percentage calculation
- Filtering by status & search

#### โ Storage Module (MinIO)
- File upload/download
- Presigned URLs
- Bucket management

---

## ๐ฏ ุงูุฎุทูุฉ ุงูุชุงููุฉ: ุชุดุบูู Backend

### ุงููุชุทูุจุงุช
ูุฌุจ ุชุดุบูู PostgreSQL ุฃููุงู:

```bash
# ุฎูุงุฑ 1: Docker (ููุตู ุจู)
docker run --name postgres-dev -e POSTGRES_PASSWORD=postgres123 -p 5432:5432 -d postgres:16

# ุฎูุงุฑ 2: ุชุซุจูุช ูุญูู
# ุชุฃูุฏ ูู ุชุดุบูู PostgreSQL ุนูู port 5432
```

### ุงูุฎุทูุงุช

#### 1. ุชุญุฏูุซ ููู .env (ุฅุฐุง ูุฒู ุงูุฃูุฑ)

```env
DATABASE_URL="postgresql://postgres:postgres123@localhost:5432/company_docs?schema=public"
JWT_SECRET=super-secret-key-change-in-production-must-be-32-chars-min
JWT_REFRESH_SECRET=refresh-secret-key-change-in-production-also-32-chars
```

#### 2. ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
# ุฅูุดุงุก ุงูุฌุฏุงูู (Migration)
npx prisma migrate dev --name init

# ููุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุจูุงูุงุช ุชุฌุฑูุจูุฉ
npm run seed
```

#### 3. ุชุดุบูู Backend

```bash
npm run start:dev
```

โ ุฅุฐุง ุฑุฃูุช:
```
๐ Application is running on: http://localhost:5000
๐ API Documentation: http://localhost:5000/api-docs
โ Database connected successfully
```

**ูุนูู Backend ูุนูู ุจูุฌุงุญ!** ๐

---

## ๐งช ุงุฎุชุจุงุฑ ุงูู API

### 1. Health Check

```bash
curl http://localhost:5000/api/v1/health
```

### 2. ุชุณุฌูู ุงูุฏุฎูู

```bash
curl -X POST http://localhost:5000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@companydocs.com","password":"Admin@123"}'
```

ุณูุนุทูู response ูุซู:

```json
{
  "success": true,
  "data": {
    "access_token": "eyJhbGc...",
    "refresh_token": "eyJhbGc...",
    "expires_in": 900,
    "user": {
      "id": "...",
      "email": "admin@companydocs.com",
      "firstName": "Super",
      "lastName": "Admin",
      "role": "SUPER_ADMIN"
    }
  }
}
```

### 3. ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู

```bash
curl http://localhost:5000/api/v1/auth/me \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN_HERE"
```

### 4. ุงูุญุตูู ุนูู ุงูุดุฑูุงุช

```bash
curl http://localhost:5000/api/v1/companies \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN_HERE"
```

---

## ๐ ุงุณุชูุดุงู ุงูู API

ุงูุชุญ ุงููุชุตูุญ ุนูู:
- **Swagger Documentation**: http://localhost:5000/api-docs

ููุง ููููู:
- โ ุฑุคูุฉ ุฌููุน ุงูู Endpoints
- โ ุงุฎุชุจุงุฑ ุงูู API ูุจุงุดุฑุฉ
- โ ุฑุคูุฉ ุงูู Request/Response schemas

---

## ๐ฅ ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ

| ุงูุฏูุฑ | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ูููุฉ ุงููุฑูุฑ |
|-------|-------------------|-------------|
| Super Admin | admin@companydocs.com | Admin@123 |
| Supervisor | supervisor@companydocs.com | Supervisor@123 |
| Employee | employee@companydocs.com | Employee@123 |

---

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### Prisma Studio (ูุงุฌูุฉ ูุฑุฆูุฉ)

```bash
npm run studio
```

ุณููุชุญ ุนูู: http://localhost:5555

ููุง ููููู:
- โ ุชุตูุญ ุฌููุน ุงูุฌุฏุงูู
- โ ุชุนุฏูู ุงูุจูุงูุงุช ูุจุงุดุฑุฉ
- โ ุฅุถุงูุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ

### ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ

- `users` - ุงููุณุชุฎุฏููู
- `companies` - ุงูุดุฑูุงุช
- `documents` - ุงููุซุงุฆู
- `company_shares` - ูุดุงุฑูุฉ ุงูุดุฑูุงุช
- `access_requests` - ุทูุจุงุช ุงููุตูู
- `comments` - ุงูุชุนูููุงุช
- `notifications` - ุงูุฅุดุนุงุฑุงุช
- `sessions` - ุงูุฌูุณุงุช
- `audit_logs` - ุณุฌูุงุช ุงูุชุฏููู

---

## ๐ง ุงูุฃูุงูุฑ ุงููููุฏุฉ

```bash
# Development
npm run start:dev          # ุชุดุบูู ูู ูุถุน ุงูุชุทููุฑ

# Database
npx prisma studio          # ูุชุญ ูุงุฌูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
npx prisma migrate dev     # ุฅูุดุงุก migration ุฌุฏูุฏ
npm run seed              # ููุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุจูุงูุงุช ุชุฌุฑูุจูุฉ

# Code Quality
npm run lint              # ูุญุต ุงูุฃููุงุฏ
npm run format            # ุชูุณูู ุงูุฃููุงุฏ

# Testing
npm run test              # ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช
```

---

## โ๏ธ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### 1. ุฎุทุฃ: "Can't reach database server"

```bash
# ุชุฃูุฏ ูู ุชุดุบูู PostgreSQL
# ุฎูุงุฑ Docker:
docker ps  # ุชุญูู ูู ุชุดุบูู container

# ุฃู ุงุจุฏุฃู:
docker start postgres-dev
```

### 2. ุฎุทุฃ: "Prisma Client not generated"

```bash
npx prisma generate
```

### 3. ุฎุทุฃ: "Port 5000 already in use"

```bash
# ุบููุฑ PORT ูู .env
PORT=5001
```

### 4. ุฎุทุฃ ูู ุงูู Migration

```bash
# ุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฅุนุงุฏุฉ ุฅูุดุงุฆูุง
npx prisma migrate reset
npm run seed
```

---

## ๐ ุงูู Modules ุงููุชุจููุฉ (ุงุฎุชูุงุฑู)

ูููู ุฅุถุงูุชูุง ูุงุญูุงู ุญุณุจ ุงูุญุงุฌุฉ:

- โณ Documents Module (ุฑูุน ูุฅุฏุงุฑุฉ ุงููููุงุช)
- โณ Shares Module (ูุดุงุฑูุฉ ุงูุดุฑูุงุช)
- โณ Notifications Module (ุงูุฅุดุนุงุฑุงุช)
- โณ Comments Module (ุงูุชุนูููุงุช)
- โณ Dashboard Module (ุงูุฅุญุตุงุฆูุงุช)
- โณ Reports Module (ุงูุชูุงุฑูุฑ)
- โณ Search Module (ุงูุจุญุซ ุงููุชูุฏู)

---

## ๐ ูุจุฑูู!

Backend ุฌุงูุฒ ููุนูู ุงูุขู! โ

### ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงูููุชุฑุญุฉ:

1. โ **ุงุฎุชุจุฑ ุงูู API** ุจุงุณุชุฎุฏุงู Swagger
2. โ **ุงุณุชูุดู ูุงุนุฏุฉ ุงูุจูุงูุงุช** ุจุงุณุชุฎุฏุงู Prisma Studio
3. โ **ุงุจุฏุฃ ูู ุชุทููุฑ Frontend** (Next.js)
4. โ **ุฃุถู ุงูู Modules ุงููุชุจููุฉ** ุญุณุจ ุงูุญุงุฌุฉ

---

## ๐ ุงูุฏุนู

- **ุงููุซุงุฆู**: `backend/README.md`
- **ุฅุนุฏุงุฏ ููุตู**: `backend/SETUP.md`
- **Swagger**: http://localhost:5000/api-docs
- **Prisma Schema**: `backend/prisma/schema.prisma`

---

**ุขุฎุฑ ุชุญุฏูุซ**: ููููุจุฑ 2025

